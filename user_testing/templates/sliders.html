<!DOCTYPE html>
<html lang="en">
<head>
  <title>Test</title>
  <meta charset="utf-8">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <style>
      #sliders {
          width: 1000px;
          margin: 1em;
      }
      #sliders li {
           margin-bottom: 10px;
      }
      #sliders div {
           margin-bottom: 10px;
           width:600px;
      }
      tr {
          padding-bottom:50px;
          width: 100px;
      }
      td {
          width: 100px;
          margin: 1em;
      }
      table {
          margin-top: 1em;
          width:50% !important;
          margin-left: auto !important;
          margin-right: auto !important;
      }
      .buttonHolder {
          text-align: center;
      }
      .slider1 {
        background: #c2c900;
      }
      .slider2 {
        background: #00c9c9;
      }
      .slider3 {
        background: #28c900;
      }
      .slider4 {
        background: #c90000;
      }
      .slider5 {
        background: #b800c9;
      }
      .slider6 {
        background: #c97c00;
      }
      .slider7 {
        background: #f0f0f0;
      }
      body {
          text-align: center !important;
      }
      
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

  </head>
    
    
  <body>
  <br>
  <b>User data:</b>
  <br>   
  {{dataframe | safe}}
  <br><br>
  <b>Model prediction: 343</b>
      
  <p>Please indicate how important each of the following features are to you:</p>
  <table id = "sliders">
    <tr>
        <th>isco code</th>
        <th>
            <!-- insert value between >*here*</div> and add a percentage after </span>-->
            <div class="slider slider1"></div>
            <span class="value", name="20"></span>
        </th>
    </tr>
    <tr>
        <th>company name</th>
        <th>
            <div class="slider slider2"></div>
            <span class="value", name="20"></span>
        </th>
    </tr>
    <tr>
        <th>education</th>
        <th>
            <div class="slider slider3"></div>
            <span class="value", name="20"></span>
        </th>
      </tr>
      <tr>
        <th>skills</th>

        <th>
            <div class="slider slider4"></div>
            <span class="value", name="20"></span>
        </th>    
      </tr>
      <tr>
        <th>Licenses</th>

        <th>
            <div class="slider slider5"></div>
            <span class="value", name="20"></span>
        </th>    
      </tr>
      <tr>
        <th>Languages</th>

        <th>
            <div class="slider slider6"></div>
            <span class="value", name="20"></span>
        </th>    
      </tr>
      <tr>
        <th>Other stuff</th>

        <th>
            <div class="slider slider7"></div>
            <span class="value", name="20"></span>
        </th>    
      </tr>
    </table>
      
    <div class="buttonHolder">
        <input type="submit" value="Submit" class="btn btn-primary">
    </div>

  <script src="//code.jquery.com/jquery-1.10.2.js"></script>
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <script type='text/javascript'>
        
    var sliders = $("#sliders .slider");

    sliders.each(function() {
        var value = parseInt($(this).text(), 10),
            availableTotal = 100;

        $(this).empty().slider({
            value: 100 / sliders.length,
            min: 0,
            max: 100,
            range: "max",
            step: 0.1,
            animate: 100,
            slide: function(event, ui) {

                // Get current total
                var total = 0;    

                sliders.not(this).each(function() {
                    total += $(this).slider("option", "value");
                });    


                var max = availableTotal - total;            

                if (max - ui.value >= 0) {
                    // Need to do this because apparently jQ UI
                    // does not update value until this event completes
                    total += ui.value;
                    // console.log(max-ui.value);
                    $(this).siblings().attr("name", ui.value);
                } else {
                    return false;
                }
            }
        });
    });
  </script>
    <script>
        $(document).ready(function(){
          $(".btn-primary").on("click", function(event) {
            var sliders = $(".value");
            var values = [];

            sliders.each(function() {
                values.push($(this).attr("name"));// values.push(parseInt($(this).attributes["name"].value, 10));
            });

            $.ajax({
                type: "POST",
                    url: "{{url_for('store_results')}}",
                    contentType: 'application/json',
                    data: JSON.stringify({values: values})
                }).done(function(data) {
                    location.reload();
                });
            });
        });
      </script>

</body>
</html>